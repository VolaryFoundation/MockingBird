#frame
  #page_title
    %h1= @eagle_group['name']
  #main
    %section{id: 'composit_view'}
      %h2 About this Group
      #main-info-details
        -if @eagle_group['images'].present? && @eagle_group['images'][0].present? && !@eagle_group['images'][0].empty?
          %img.group_img.resize{src: @eagle_group['images'][0], extra_info_state: @eagle_group['location']['state'], extra_info_city: @eagle_group['location']['city']}
        -else
          %img.group_img.resize{src: "http://placehold.it/180x125.png", extra_info_state: @eagle_group['location']['state'], extra_info_city: @eagle_group['location']['city']}
        %ul
          %li
            - if @eagle_group['location'].present?
              %span{ class:'label'}= location_to_html(@eagle_group['location'])
            - else
              %span{ class:'label'}Location Unknown
          %li 
            %span{class:'label'}Range of Operation:
            = @eagle_group['range'].present? ?  @eagle_group['range'] : 'Local'    
          %li 
            %span{class:'label'}Number of Members:
            = @eagle_group['size'].present? ?  @eagle_group['size'] : 'Unknown'
          %li 
            %span{class: 'label'}Last Updated: 
            = @mb_group.updated_at.present? ? @mb_group.updated_at : 'Unknown'
          %li 
      #main-info-description
        -if @eagle_group['description']
          = @eagle_group['description']
      #main-info-keywords
        %ul
          %li <span class='label'>Tags: </span>
          -if @mb_group.present? && @mb_group.present?
            - @mb_group.tags.each do |word|
              %li=word.titleize
          -else
            %li This group has no tags
          
      #main-info-description
        %h2 Links
        - if @mb_group.links.present?
          %ul.list
            - @mb_group.links.select { |l| not l.url.include? "?op=leaders" }.each do |link|
              %li 
                %a{href: "#{link.url}"}= link.name
            
        -else
          This group has no links.
    %section{id: 'mockingbird_view'}
      %h2 Secular Connect Info
      - if @mb_group.present?
        .edit_links
          -if (current_user.role == 'admin')
            %a{href: '#mockingbird', class: 'edit_link'}Edit
            -if @mb_group.pending_user.present? && @mb_group.user.nil?
              |
              %form.no_form{action: "/groups/#{@mb_group.id}/approve", method: 'post'}
                %input#approve_claim_link.link.on_white{type: 'submit', :value => 'Approve'}
          - elsif (current_user == @mb_group.user)
            %a{href: '#mockingbird', class: 'edit_link'}Edit fields here
          -elsif current_user.present? && @mb_group.pending_user.blank?
            %form.no_form{action: "/groups/#{@mb_group.id}/claim", method: 'post'}
              %input#claim_group_link.link.on_white{type: 'submit', :value => 'Claim Group'}
        %ul.mocking_bird_details
          %li.name
            %span.label Name: 
            %span.text= @mb_group.name if @mb_group.name
          %li.location
            %span.label Location:
            %span.text= location_to_html(@mb_group.location) if @mb_group.location.present?
          %li.range
            %span.label Range: 
            %span.text= @mb_group.range if @mb_group.range.present?
          %li.tags
            %span.label Tags: 
            %span.text= @mb_group.tags.join(', ').titleize if @mb_group.tags.present?
          %li.description
            %span.label Description:
            %br
            %span.text= @mb_group.description if @mb_group.description.present?
          - if @mb_group.links.present?
            %li
              %span.label Links:
              %ul.list
                - @mb_group.links.select { |l| not l.url.include? "?op=leaders" }.each do |link|
                  %li 
                    %a{href: "#{link.url}"}= link.name
          -else
            %li
              %span.label Links:
              This group has no links.
    %section{id: 'mockingbird_edit', class: 'hidden'}
      %h2 Edit MockingBird Info
      .edit_links
        %a{href: '#mockingbird', class: 'edit_link cancel'}Cancel
      #group_error.hidden
      %form#submit_groups{action: "#{@mb_group.id}", method: :post}
        %label Name:
        %input{type: "text", name: 'group[name]', value: @mb_group.name}
        %br
        -#############Location Field####################
        %label Location:
        %input#autocomplete{placeholder: "#{location_to_html(@mb_group.location)}", onFocus: "geolocate()", type:"text"}
        %br
        -#############Google Crap Field####################
        .hidden
          %input.field#address{disabled: "true", name: "group[location][address]"}
          %input.field#street_number{disabled: "true", name: "group[location][street_num]"}
          %input.field#route{disabled: "true", name: "group[location][street_address]"}
          %input.field#locality{disabled: "true", name: "group[location][city]"}
          %input.field#administrative_area_level_1{disabled: "true", name: "group[location][state]"}
          %input.field#postal_code{disabled: "true", name: "group[location][postal_code]"}
          %input.field#country{disabled: "true", name: "group[location][country]"}
        -#############End Google Crap#####################
        %label Range:
        %select{name: 'group[range]'}
          %option{value: 'local', :selected => @mb_group.range == "local"} Local
          %option{value: 'regional', :selected => @mb_group.range == "regional"} Regional
          %option{value: 'nationwide', :selected => @mb_group.range == "nationwide"} Nationwide
          %option{value: 'international', :selected => @mb_group.range == "international"} International
        %br
        %label Description:
        %textarea{ name: 'group[description]', rows: "10", cols: "70"}=@mb_group.description
        %br
        %input{type: "submit", value: "Save"}
        %a{href: '#mockingbird', class: 'cancel'}Cancel
        

    %section{id: 'meetup_view'}
      %h2 Meetup Info
      - if @meetup_group.kind_of?(Hash) && @meetup_group.any?
        .edit_links
          %a{href: "#{@eagle_group['refs']['meetup']}/manage", class: 'edit_link', target: '_blank'}Edit on Meetup.com
        %ul
          - @meetup_group.each do |key, value|
            - unless key == 'keywords' || key == 'images'
              %li
                %span.label="#{key.titleize}:"
                =attribute_seperator(value, key)
      -elsif @meetup_group == nil
        %p We do not have a Meetup link for this group
      -elsif @meetup_group.kind_of?(Hash) && @meetup_group.empty?
        %p We have a link to the Meetup Group but no data could be collected

    %section{id: 'facebook_view'}
      %h2 Facebook Info
      - if @facebook_group.kind_of?(Hash) && !@facebook_group.empty?
        .edit_links
          %a{href: "#{@eagle_group['refs']['facebook']}", class: 'edit_link', target: '_blank'}Edit on Facebook.com
        %ul
          - @facebook_group.each do |key, value|
            - unless key == 'keywords' || key == 'images'
              %li
                %span.label="#{key.titleize}:"
                =attribute_seperator(value, key)
      -elsif @facebook_group == nil
        %p We do not have a Facebook link for this group
      -elsif @facebook_group.kind_of?(Hash) && @facebook_group.empty?
        %p We have a link to the Facebook Group but no data could be collected
      
  
